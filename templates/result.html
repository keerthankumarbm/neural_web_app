{% extends "base.html" %}
{% block content %}

<div class="container">

    <!-- Prediction Result Card -->
    <div class="card dashboard-glow">
        <h2 style="font-size:28px; margin-bottom:15px;">
            ðŸ“Š Prediction Result for {{ symbol }}
        </h2>

        <p style="font-size:18px; margin-bottom:8px;">
            <strong>Current Price:</strong> â‚¹ {{ current }}
        </p>

        <p style="font-size:18px; margin-bottom:10px;">
            <strong>Predicted Price:</strong> â‚¹ {{ predicted }}
        </p>

        {% if "Bullish" in trend %}
            <p class="trend-up" style="font-size:20px;">
                ðŸ“ˆ {{ trend }}
            </p>
        {% else %}
            <p class="trend-down" style="font-size:20px;">
                ðŸ“‰ {{ trend }}
            </p>
        {% endif %}
    </div>

    <!-- Chart Section -->
    <div class="card">
        <h3 style="margin-bottom:20px;">
            ðŸ“ˆ Stock Chart (Close vs MA20)
        </h3>

        <div class="chart-container">
            <canvas id="stockChart"></canvas>
        </div>
    </div>

    <!-- Back Button -->
    <div style="margin-top:20px;">
        <a href="/dashboard">
            <button>â¬… Back to Dashboard</button>
        </a>
    </div>

</div>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    const dates = JSON.parse('{{ dates | tojson | safe }}');
    const closes = JSON.parse('{{ closes | tojson | safe }}');
    const ma20 = JSON.parse('{{ ma20 | tojson | safe }}');

    const ctx = document.getElementById('stockChart').getContext('2d');

    new Chart(ctx, {
        type: 'line',
        data: {
            labels: dates,
            datasets: [
                {
                    label: 'Close Price',
                    data: closes,
                    borderColor: '#00f2ff',
                    backgroundColor: 'rgba(0,242,255,0.1)',
                    tension: 0.3,
                    borderWidth: 3,
                    pointRadius: 2
                },
                {
                    label: 'MA20',
                    data: ma20,
                    borderColor: '#ff00ff',
                    backgroundColor: 'rgba(255,0,255,0.1)',
                    tension: 0.3,
                    borderWidth: 3,
                    pointRadius: 2
                }
            ]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    labels: {
                        color: "#000",
                        font: {
                            size: 14
                        }
                    }
                }
            },
            scales: {
                x: {
                    ticks: {
                        color: "#000"
                    }
                },
                y: {
                    ticks: {
                        color: "#000"
                    }
                }
            }
        }
    });
</script>

{% endblock %}